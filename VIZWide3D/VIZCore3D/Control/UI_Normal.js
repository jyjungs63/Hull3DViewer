let UINormal=function(a,b){let c=this,d=undefined,e=undefined;this['base']=b['UIBase'],this['base'](a,b),f();function f(){}this['UIBegin']=function(){c['base']['prototype']['UIBegin']['call'](c);},this['UIEnd']=function(){d!==undefined&&(a['Handle']['ClearStateById'](d['id']),d['enable']=![],d=undefined),e=undefined,c['base']['prototype']['UIEnd']['call'](c);},this['mouseDown']=function(g,h,i){if(i===0x0){if(!c['KeyPress']['ctrlKey']&&!c['KeyPress']['altKey']&&c['KeyPress']['shiftKey']){a['Mode']['SelectBox']();let j=a['Control']['GetUIMode']();j['mouseDown'](g,h,i);return;}if(c['KeyPress']['ctrlKey']&&!c['KeyPress']['altKey']&&c['KeyPress']['shiftKey']){a['Mode']['BoxZoom']();let k=a['Control']['GetUIMode']();k['mouseDown'](g,h,i);return;}}if(d!==undefined)d['enable']&&(d['state']=b['Enum']['HANDLE_MOUSE_STATE']['DOWN'],a['Handle']['ReleaseInterval']());else{if(i===0x0){e=undefined;if(a['Data']['Review']['EnableViewReviewMove']){let l=a['Data']['Review']['PickMouse'](g,h);l!==undefined&&(e=a['Data']['Review']['GetReview'](l));}}}if(a['IsUseProgressive']())a['Renderer']['enableRenderLimit']=!![];return c['base']['prototype']['mouseDown']['call'](c,g,h,i);},this['mouseMove']=function(g,h){let i=a['Handle']['Handler']();if(i['length']>0x0){const j=new b['Matrix4']()['copy'](a['Camera']['matMVP']);if(d!==undefined&&d['state']===b['Enum']['HANDLE_MOUSE_STATE']['DOWN']){c['actionEnabled']=![];if(g!==c['mouseLastPosition']['x']||h!==c['mouseLastPosition']['y']){let k=d;switch(k['itemType']){case b['Enum']['HANDLER_TYPE']['MODEL']:{}break;case b['Enum']['HANDLER_TYPE']['CLIPPING']:{let l=k['object'];if(k['axis']['x']['enable']&&k['axis']['x']['select']){let n=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);n&&l['center']['copy'](n['matrix']['multiplyVector'](l['center']));}else{if(k['axis']['y']['enable']&&k['axis']['y']['select']){let o=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);o&&l['center']['copy'](o['matrix']['multiplyVector'](l['center']));}else{if(k['axis']['z']['enable']&&k['axis']['z']['select']){let p=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);p&&l['center']['copy'](p['matrix']['multiplyVector'](l['center']));}else{if(k['rotate']['x']['enable']&&k['rotate']['x']['select']){let q=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);if(q){let r=q['matrix'];r['setPosition'](new b['Vector3']()),k['axis']['x']['normal']['copy'](r['multiplyVector'](k['axis']['x']['normal'])),k['axis']['y']['normal']['copy'](r['multiplyVector'](k['axis']['y']['normal'])),k['axis']['z']['normal']['copy'](r['multiplyVector'](k['axis']['z']['normal'])),l['normal']['copy'](r['multiplyVector'](l['normal']));}}else{if(k['rotate']['y']['enable']&&k['rotate']['y']['select']){let s=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);if(s){let t=s['matrix'];t['setPosition'](new b['Vector3']()),k['axis']['x']['normal']['copy'](t['multiplyVector'](k['axis']['x']['normal'])),k['axis']['y']['normal']['copy'](t['multiplyVector'](k['axis']['y']['normal'])),k['axis']['z']['normal']['copy'](t['multiplyVector'](k['axis']['z']['normal'])),l['normal']['copy'](t['multiplyVector'](l['normal']));}}else{if(k['rotate']['z']['enable']&&k['rotate']['z']['select']){let u=a['Handle']['UpdateTransformByMouseMove'](k,g,h,c['mouseLastPosition']['x'],c['mouseLastPosition']['y'],c['KeyPress']['shiftKey']);if(u){let v=u['matrix'];v['setPosition'](new b['Vector3']()),k['axis']['x']['normal']['copy'](v['multiplyVector'](k['axis']['x']['normal'])),k['axis']['y']['normal']['copy'](v['multiplyVector'](k['axis']['y']['normal'])),k['axis']['z']['normal']['copy'](v['multiplyVector'](k['axis']['z']['normal'])),l['normal']['copy'](v['multiplyVector'](l['normal']));}}}}}}}let m=a['Data']['ClippingEvent'](b['Enum']['CLIPPING_TYPE']['TRANSFORM'],l);a['EventHandler']['dispatchEvent'](b['Enum']['EVENT_TYPES']['Section']['Changed'],m),l['changed']=!![],a['Clipping']['Update'](),a['Renderer']['MainFBClear'](),a['Renderer']['Render']();}break;}}}else{if(!c['mouseLeftDown']){if(d!==undefined&&d['state']===b['Enum']['HANDLE_MOUSE_STATE']['OVER'])a['Renderer']['Render']();a['Handle']['ClearState'](),a['Clipping']['PickPlane'](g,h),d=a['Handle']['Pick'](g,h),d!==undefined&&(d['state']=b['Enum']['HANDLE_MOUSE_STATE']['OVER'],a['Renderer']['Render']());}}}if(c['actionEnabled']&&c['mouseLeftDown']&&e!==undefined){c['actionEnabled']=![];let w=e;if(w['itemType']===b['Enum']['REVIEW_TYPES']['RK_2D_NOTE']){let z=new b['Vector3'](g-c['mouse']['x'],h-c['mouse']['y'],0x0),A=new b['Vector3']()['copy'](w['text']['position']),B=new b['Vector3'](A['x']+z['x'],A['y']+z['y'],0x0);w['text']['position']['set'](B['x'],B['y'],0.5),a['Renderer']['Render']();}else{let C=new b['Matrix4']()['copy'](a['Camera']['matMVP']),D=a['Camera']['world2ScreenWithMatrix'](C,new b['Vector3']()['copy'](w['text']['position'])),E=new b['Vector3'](g-c['mouse']['x'],h-c['mouse']['y'],0x0),F=a['Camera']['screen2WorldWithMatrix'](C,new b['Vector3'](D['x']+E['x'],D['y']+E['y'],D['z']));w['text']['position']['copy'](F),a['Renderer']['Render']();}}c['base']['prototype']['mouseMove']['call'](c,g,h),c['actionEnabled']=!![];},this['mouseUp']=function(g,h,i){d!==undefined&&(a['Handle']['ClearStateById'](d['id']),d=undefined);if(a['IsUseProgressive']())a['Renderer']['enableRenderLimit']=![];let j=function(k){let l=![],m=k['view'],n=k['VIZCore'];const o=new n['Matrix4']()['copy'](m['Camera']['matMVP']);for(let p=m['Data']['Reviews']['length']-0x1;p>=0x0;p--){let q=m['Data']['Reviews'][p];if(!q['visible'])continue;let r=![];if(q['itemType']===n['Enum']['REVIEW_TYPES']['RK_IMAGE_NOTE']&&q['drawitem']['custom']!==undefined){if(q['drawitem']['custom']['image']!==undefined){let s=q['drawitem']['custom']['size']['x']/0x2,t=q['drawitem']['custom']['size']['y']/0x2,u=new n['Vector3']()['copy'](q['drawitem']['position'][0x0]),v=m['Renderer']['Util']['GetScreenPositionByMatrix'](o,new n['Vector3']()['copy'](u)),w=new n['Vector3'](v['x']-s,v['y']-t*0x2,0x0),z=new n['Vector3'](v['x']+s,v['y'],0x0);if(g>w['x']&&g<z['x']&&h>w['y']&&h<z['y']){l=!![],m['EventHandler']['dispatchEvent'](n['Enum']['EVENT_TYPES']['Review']['Selected'],q),m['Data']['OnEvent'](n['Enum']['EVENT_TYPES']['Review']['Selected'],q),m['Control']['MouseEvent']=!![],m['Control']['MouseEventData']=q,r=!![];break;}}}if(q['itemType']===n['Enum']['REVIEW_TYPES']['RK_HEADER_NOTE']&&q['header']['icon']['image']!==undefined){let A=new n['Vector3']()['copy'](q['text']['position']),B=m['Renderer']['Util']['GetScreenPositionByMatrix'](o,A),C=new n['Vector2'](B['x']+q['header']['icon']['rect']['x'],B['y']+q['header']['icon']['rect']['y']),D=new n['Vector3'](C['x'],C['y'],0x0),E=new n['Vector3'](C['x']+q['header']['icon']['rect']['width'],C['y']+q['header']['icon']['rect']['height'],0x0);if(g>D['x']&&g<E['x']&&h>D['y']&&h<E['y']){l=!![],m['Control']['MouseEvent']=!![],m['Control']['MouseEventData']=q;if(q['header']['icon']['onClick']!==undefined){r=!![];let F=m['Data']['EventItem']();F['type']=n['Enum']['EVENT_TYPES']['Review']['Click'],F['event']=m['Control']['CurrentEvent'],F['info']=q,q['header']['icon']['onClick'](F);}break;}}if(q['itemType']===n['Enum']['REVIEW_TYPES']['RK_3D_NOTE']&&q['icon']['image']!==undefined){let G=new n['Vector3']()['copy'](q['text']['position']),H=m['Renderer']['Util']['GetScreenPositionByMatrix'](o,G),I=new n['Vector2'](H['x']+q['icon']['rect']['x'],H['y']+q['icon']['rect']['y']),J=new n['Vector3'](I['x'],I['y'],0x0),K=new n['Vector3'](I['x']+q['icon']['rect']['width'],I['y']+q['icon']['rect']['height'],0x0);if(g>J['x']&&g<K['x']&&h>J['y']&&h<K['y']){l=!![],m['Control']['MouseEvent']=!![],m['Control']['MouseEventData']=q;if(q['icon']['onClick']!==undefined){r=!![];let L=m['Data']['EventItem']();L['type']=n['Enum']['EVENT_TYPES']['Review']['Click'],L['event']=m['Control']['CurrentEvent'],L['info']=q,q['icon']['onClick'](L);}break;}}if(r===![])for(let M=0x0;M<q['rect']['length'];M++){let N=q['rect'][M];if(N['isPointInRect'](g,h)===![])continue;l=!![],q['selection']=!![];if(q['onClick']!==undefined){let O=m['Data']['EventItem']();O['type']=n['Enum']['EVENT_TYPES']['Review']['Click'],O['event']=m['Control']['CurrentEvent'],O['info']=q,q['onClick'](O);}else m['EventHandler']['dispatchEvent'](n['Enum']['EVENT_TYPES']['Review']['Selected'],q),m['Data']['OnEvent'](n['Enum']['EVENT_TYPES']['Review']['Selected'],q);m['Configuration']['Event']['EnableReviewSelectedPosition']&&(m['Control']['MouseEvent']=!![],m['Control']['MouseEventData']=q);break;}if(l)break;}return l;};if(c['GetMouseClick'](g,h)){if(!c['KeyPress']['ctrlKey'])a['Data']['Review']['SelectAll'](![]);let k=j(this);if(k){a['Renderer']['Render'](),c['actionEnabled']=![];let l=c['base']['prototype']['mouseUp']['call'](c,g,h,i);return c['actionEnabled']=!![],l;}}return e=undefined,c['base']['prototype']['mouseUp']['call'](c,g,h,i);},this['mouseWheel']=function(g,h,i){c['base']['prototype']['mouseWheel']['call'](c,g,h,i);},this['mouseDoubleClick']=function(g,h,i){c['base']['prototype']['mouseDoubleClick']['call'](c,g,h,i);},this['touchStart']=function(g){if(g['length']>0x0){if(g['length']===0x1){let h=this['view']['Control']['GetCalcTouchPos'](g[0x0]),i=h['x'],j=h['y'],k=a['Handle']['Handler']();if(k['length']>0x0){if(d===undefined){if(!c['mouseLeftDown']){if(d!==undefined&&d['state']===b['Enum']['HANDLE_MOUSE_STATE']['OVER'])a['Renderer']['Render']();a['Handle']['ClearState'](),a['Clipping']['PickPlane'](i,j),d=a['Handle']['Pick'](i,j),d!==undefined&&(d['state']=b['Enum']['HANDLE_MOUSE_STATE']['OVER'],a['Renderer']['Render']());}}}if(d!==undefined){if(d['enable'])d['state']=b['Enum']['HANDLE_MOUSE_STATE']['DOWN'];}else{e=undefined;if(a['Data']['Review']['EnableViewReviewMove']){let l=a['Data']['Review']['PickMouse'](i,j);l!==undefined&&(e=a['Data']['Review']['GetReview'](l));}}}if(a['IsUseProgressive']())a['Renderer']['enableRenderLimit']=!![];}c['base']['prototype']['touchStart']['call'](c,g);},this['touchMove']=function(g){if(g['length']>0x0){if(g['length']===0x1){let h=this['view']['Control']['GetCalcTouchPos'](g[0x0]),i=h['x'],j=h['y'],k=a['Handle']['Handler']();if(k['length']>0x0){const l=new b['Matrix4']()['copy'](a['Camera']['matMVP']);if(d!==undefined&&d['state']===b['Enum']['HANDLE_MOUSE_STATE']['DOWN']){c['actionEnabled']=![];if(i!==c['mouseLastPosition']['x']||j!==c['mouseLastPosition']['y']){let m=d;switch(m['itemType']){case b['Enum']['HANDLER_TYPE']['MODEL']:{}break;case b['Enum']['HANDLER_TYPE']['CLIPPING']:{let n=m['object'];if(m['axis']['x']['enable']&&m['axis']['x']['select']){let o=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);o&&n['center']['copy'](o['matrix']['multiplyVector'](n['center']));}else{if(m['axis']['y']['enable']&&m['axis']['y']['select']){let p=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);p&&n['center']['copy'](p['matrix']['multiplyVector'](n['center']));}else{if(m['axis']['z']['enable']&&m['axis']['z']['select']){let q=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);q&&n['center']['copy'](q['matrix']['multiplyVector'](n['center']));}else{if(m['rotate']['x']['enable']&&m['rotate']['x']['select']){let r=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);if(r){let s=r['matrix'];s['setPosition'](new b['Vector3']()),m['axis']['x']['normal']['copy'](s['multiplyVector'](m['axis']['x']['normal'])),m['axis']['y']['normal']['copy'](s['multiplyVector'](m['axis']['y']['normal'])),m['axis']['z']['normal']['copy'](s['multiplyVector'](m['axis']['z']['normal'])),n['normal']['copy'](s['multiplyVector'](n['normal']));}}else{if(m['rotate']['y']['enable']&&m['rotate']['y']['select']){let t=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);if(t){let u=t['matrix'];u['setPosition'](new b['Vector3']()),m['axis']['x']['normal']['copy'](u['multiplyVector'](m['axis']['x']['normal'])),m['axis']['y']['normal']['copy'](u['multiplyVector'](m['axis']['y']['normal'])),m['axis']['z']['normal']['copy'](u['multiplyVector'](m['axis']['z']['normal'])),n['normal']['copy'](u['multiplyVector'](n['normal']));}}else{if(m['rotate']['z']['enable']&&m['rotate']['z']['select']){let v=a['Handle']['UpdateTransformByMouseMove'](m,i,j,c['mouseLastPosition']['x'],c['mouseLastPosition']['y']);if(v){let w=v['matrix'];w['setPosition'](new b['Vector3']()),m['axis']['x']['normal']['copy'](w['multiplyVector'](m['axis']['x']['normal'])),m['axis']['y']['normal']['copy'](w['multiplyVector'](m['axis']['y']['normal'])),m['axis']['z']['normal']['copy'](w['multiplyVector'](m['axis']['z']['normal'])),n['normal']['copy'](w['multiplyVector'](n['normal']));}}}}}}}n['changed']=!![],a['Clipping']['Update'](),a['Renderer']['MainFBClear'](),a['Renderer']['Render']();}break;}}}}if(c['actionEnabled']&&e!==undefined){c['actionEnabled']=![];let z=e;if(z['itemType']===b['Enum']['REVIEW_TYPES']['RK_2D_NOTE']){let A=new b['Vector3'](i-c['mouse']['x'],j-c['mouse']['y'],0x0),B=new b['Vector3']()['copy'](z['text']['position']),C=new b['Vector3'](B['x']+A['x'],B['y']+A['y'],0x0);z['text']['position']['set'](C['x'],C['y'],0.5),a['Renderer']['Render']();}else{let D=new b['Matrix4']()['copy'](a['Camera']['matMVP']),E=a['Camera']['world2ScreenWithMatrix'](D,new b['Vector3']()['copy'](z['text']['position'])),F=new b['Vector3'](i-c['mouse']['x'],j-c['mouse']['y'],0x0),G=a['Camera']['screen2WorldWithMatrix'](D,new b['Vector3'](E['x']+F['x'],E['y']+F['y'],E['z']));z['text']['position']['copy'](G),a['Renderer']['Render']();}}}}c['base']['prototype']['touchMove']['call'](c,g),c['actionEnabled']=!![];},this['touchEnd']=function(g){if(g['length']===0x0){d!==undefined&&(a['Handle']['ClearStateById'](d['id']),d=undefined);if(a['IsUseProgressive']())a['Renderer']['enableRenderLimit']=![];}let h=function(k,l,m){let n=![],o=k['view'],p=k['VIZCore'];const q=new p['Matrix4']()['copy'](o['Camera']['matMVP']);for(let r=o['Data']['Reviews']['length']-0x1;r>=0x0;r--){let s=o['Data']['Reviews'][r];if(!s['visible'])continue;let t=![];if(s['itemType']===p['Enum']['REVIEW_TYPES']['RK_IMAGE_NOTE']&&s['drawitem']['custom']!==undefined){if(s['drawitem']['custom']['image']!==undefined){let u=s['drawitem']['custom']['size']['x']/0x2,v=s['drawitem']['custom']['size']['y']/0x2,w=new p['Vector3']()['copy'](s['drawitem']['position'][0x0]),z=o['Renderer']['Util']['GetScreenPositionByMatrix'](q,new p['Vector3']()['copy'](w)),A=new p['Vector3'](z['x']-u,z['y']-v*0x2,0x0),B=new p['Vector3'](z['x']+u,z['y'],0x0);if(l>A['x']&&l<B['x']&&m>A['y']&&m<B['y']){n=!![],o['EventHandler']['dispatchEvent'](p['Enum']['EVENT_TYPES']['Review']['Selected'],s),o['Data']['OnEvent'](p['Enum']['EVENT_TYPES']['Review']['Selected'],s),t=!![];break;}}}if(s['itemType']===p['Enum']['REVIEW_TYPES']['RK_HEADER_NOTE']&&s['header']['icon']['image']!==undefined){let C=new p['Vector3']()['copy'](s['text']['position']),D=o['Renderer']['Util']['GetScreenPositionByMatrix'](q,C),E=new p['Vector2'](D['x']+s['header']['icon']['rect']['x'],D['y']+s['header']['icon']['rect']['y']),F=new p['Vector3'](E['x'],E['y'],0x0),G=new p['Vector3'](E['x']+s['header']['icon']['rect']['width'],E['y']+s['header']['icon']['rect']['height'],0x0);if(l>F['x']&&l<G['x']&&m>F['y']&&m<G['y']){n=!![];if(s['header']['icon']['onClick']!==undefined){t=!![];let H=o['Data']['EventItem']();H['type']=p['Enum']['EVENT_TYPES']['Review']['Click'],H['event']=o['Control']['CurrentEvent'],H['info']=s,s['header']['icon']['onClick'](H);}break;}}if(s['itemType']===p['Enum']['REVIEW_TYPES']['RK_3D_NOTE']&&s['icon']['image']!==undefined){let I=new p['Vector3']()['copy'](s['text']['position']),J=o['Renderer']['Util']['GetScreenPositionByMatrix'](q,I),K=new p['Vector2'](J['x']+s['icon']['rect']['x'],J['y']+s['icon']['rect']['y']),L=new p['Vector3'](K['x'],K['y'],0x0),M=new p['Vector3'](K['x']+s['icon']['rect']['width'],K['y']+s['icon']['rect']['height'],0x0);if(l>L['x']&&l<M['x']&&m>L['y']&&m<M['y']){n=!![];if(s['icon']['onClick']!==undefined){t=!![];let N=o['Data']['EventItem']();N['type']=p['Enum']['EVENT_TYPES']['Review']['Click'],N['event']=o['Control']['CurrentEvent'],N['info']=s,s['icon']['onClick'](N);}break;}}if(t===![])for(let O=0x0;O<s['rect']['length'];O++){let P=s['rect'][O];if(P['isPointInRect'](l,m)===![])continue;n=!![],s['selection']=!![];if(s['onClick']!==undefined){let Q=o['Data']['EventItem']();Q['type']=p['Enum']['EVENT_TYPES']['Review']['Click'],Q['event']=o['Control']['CurrentEvent'],Q['info']=s,s['onClick'](Q);}else o['EventHandler']['dispatchEvent'](p['Enum']['EVENT_TYPES']['Review']['Selected'],s),o['Data']['OnEvent'](p['Enum']['EVENT_TYPES']['Review']['Selected'],s);break;}if(n)break;}return n;};if(c['_touchLastCount']===0x1){let i=this['view']['Control']['GetCalcTouchPos'](c['_touchLast'][0x0]),j=i['x'],k=i['y'];a['Data']['Review']['SelectAll'](![]);let l=h(this,j,k);if(l){a['Renderer']['Render'](),c['actionEnabled']=![];let m=c['base']['prototype']['touchEnd']['call'](c,g);return c['actionEnabled']=!![],m;}}c['base']['prototype']['touchEnd']['call'](c,g);},this['keyUp']=function(g){g===0x2e&&(a['Data']['Review']['DeleteSelectedReview'](),a['ViewRefresh']()),g===0x11&&c['base']['prototype']['keyUp'](g,this);},this['MouseLog']=function(){console['log']('UINormal.mouse\x20:\x20'+c['mouse']['x']+','+c['mouse']['y']);};};export default UINormal;