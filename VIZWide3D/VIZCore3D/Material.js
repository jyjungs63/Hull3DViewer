class Material{constructor(a,b){let c=this;this['MaterialFiles']=[];let d=new Map(),e=new Map(),f=new Map();this['currentMaterial']=undefined;let g=0x0;this['GetUniformItem']=function(i,j){let k={'value':i,'dataType':j};return k;};function h(){}h(),this['Clear']=function(){let j=Array['from'](e['keys']());for(let k=0x0;k<j['length'];k++){c['RemoveMaterial'](j[k]);}f['clear'](),d['clear'](),c['MaterialFiles']=[],c['currentMaterial']=undefined,g=0x0;},this['AddMaterial']=function(i,j){if(i['id']===0x0){let l=c['FindMaterialFromItem'](i);if(l>0x0)return l;let m=g+0x1;while(e['has'](m)){m++;}i['id']=m;}let k=i['id'];if(e['has'](i['id'])){let n=g+0x1;while(e['has'](n)){n++;}i['id']=n;}if(j!==undefined){let o=undefined;f['has'](j)?o=f['get'](j):(o=new Map(),f['set'](j,o)),o['set'](k,i['id']);}return e['set'](i['id'],i),g=Math['max'](i['id'],g),i['id'];},this['AddLoadingMaterial']=function(i,j,k,l){let m=undefined,n=undefined;d['has'](i)?m=d['get'](i):(m=new Map(),d['set'](i,m));m['has'](k)?n=m['get'](k):(n=[],m['set'](k,n));let o=function(p,q){let r={'srcID':p,'objectIdx':q};return r;};n['push'](o(j,l));},this['UpdateLoadingMaterial']=function(i){if(!d['has'](i))return;let j=d['get'](i),k=function(l,m,n){{let o=a['Data']['ModelFileManager']['GetFileAreaData'](i,m);if(o===undefined)return;let p=o['objects'];if(p===undefined)return;for(let q=0x0;q<l['length'];q++){if(l[q]['objectIdx']>=p['length'])continue;let r=p[l[q]['objectIdx']],s=c['GetMaterialBySrcID'](i,l[q]['srcID']);if(s===undefined)continue;for(let t=0x0;t<r['tag']['length'];t++){let u=r['tag'][t];if(u['material']===0x0)u['material']=s['id'];}r['flag']['updateProcess']=!![];}}};j['forEach'](k),d['delete'](i),a['MeshBlock']['Reset'](),a['Renderer']['Render']();},this['UpdateMaterialTexture']=function(j){for(let k=0x0;k<j['textureData']['length'];k++){let l=j['textureData'][k];if(l['texture']!==null)continue;if(l['width']<=0x0&&l['hegith']<=0x0)continue;if(l['src']===undefined)continue;switch(l['itemType']){case b['Enum']['TEXTURE_TYPES']['DIFFUSE']:{const m=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],m),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=m,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['NORMAL']:{const n=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],n),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=n,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['BUMP']:{const o=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],o),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=o,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['ROUGHNESS']:{const p=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],p),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=p,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['METALNESS']:{const q=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],q),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=q,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['SPECLUAR']:{const r=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],r),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=r,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['AMBIENT']:{const s=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],s),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=s,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;case b['Enum']['TEXTURE_TYPES']['OPACITY']:{const t=a['gl']['createTexture']();a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],t),a['gl']['texImage2D'](a['gl']['TEXTURE_2D'],0x0,a['gl']['RGBA'],a['gl']['RGBA'],a['gl']['UNSIGNED_BYTE'],l['src']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MIN_FILTER'],a['gl']['LINEAR_MIPMAP_NEAREST']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_MAG_FILTER'],a['gl']['LINEAR']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_S'],a['gl']['REPEAT']),a['gl']['texParameteri'](a['gl']['TEXTURE_2D'],a['gl']['TEXTURE_WRAP_T'],a['gl']['REPEAT']),a['gl']['generateMipmap'](a['gl']['TEXTURE_2D']),l['texture']=t,a['gl']['bindTexture'](a['gl']['TEXTURE_2D'],null);}break;}}},this['IsFinishMaterialTextureDownalodByID']=function(i){if(i<0x0)return!![];let j=a['Material']['GetMaterial'](i);return c['IsFinishMaterialTextureDownalod'](j);},this['IsFinishMaterialTextureDownalod']=function(j){if(j===undefined)return![];let k=!![];for(let l=0x0;l<j['textureData']['length'];l++){let m=j['textureData'][l];if(m['texture']!==null)continue;if(m['width']<=0x0&&m['hegith']<=0x0)continue;if(m['src']===undefined)continue;if(m['downloading']){k=![];break;}}return k;},this['RemoveMaterial']=function(j){if(e['has'](j)){let k=e['get'](j);for(let l=0x0;l<k['textureData']['length'];l++){let m=k['textureData'][l];if(m['texture']===null)continue;a['gl']['deleteTexture'](m['texture']);}e['delete'](j);}},this['RemoveMaterialByFile']=function(j){let k=[],l=function(m,n,o){if(!a['Util']['EqualDataTypeValue'](j,m['key']))return;k['push'](m['id']);};e['forEach'](l),d['delete'](j),f['delete'](j);for(let m=0x0;m<k['length'];m++){c['RemoveMaterial'](k[m]);};},this['GetMaterial']=function(i){return e['get'](i);},this['IsAlphaMaterial']=function(j){let k=c['GetMaterial'](j);if(k!==undefined){for(let l=0x0;l<k['textureData']['length'];l++){let m=k['textureData'][l];if(m['itemType']===b['Enum']['TEXTURE_TYPES']['OPACITY'])return!![];}return k['isAlpha'];}return![];},this['GetMaterialBySrcID']=function(i,j){if(f['has'](i)){let k=f['get'](i);if(k!==undefined){let l=k['get'](j);if(l!==undefined)return c['GetMaterial'](l);}}return undefined;},this['FindMaterialFromName']=function(i){let j=-0x1,k=function(l,m,n){if(j>0x0)return;if(l['name']['localeCompare'](i)!==0x0)return;j=l['id'];};return e['forEach'](k),j;},this['FindMaterialFromItem']=function(i){let j=-0x1,k=function(l,m,n){if(j>0x0)return;if(!a['Util']['EqualDataTypeValue'](l['key'],i['key']))return;if(l['shaderType']!==i['shaderType'])return;if(l['shiness']!==i['shiness'])return;if(l['reflectivity']!==i['reflectivity'])return;if(l['transparencyFactor']!==i['transparencyFactor'])return;if(l['color']['equals'](i['color'])===![])return;if(l['ambient']!==i['ambient'])return;if(l['ambient']!==undefined&&i['ambient']!==undefined){if(l['ambient']['equals'](i['ambient'])===![])return;}if(l['specular']!==i['specular'])return;if(l['specular']!==undefined&&i['specular']!==undefined){if(l['specular']['equals'](i['specular'])===![])return;}if(l['emissive']!==i['emissive'])return;if(l['emissive']!==undefined&&i['emissive']!==undefined){if(l['emissive']['equals'](i['emissive'])===![])return;}if(l['textureData']['length']!==i['textureData']['length'])return;for(let o=0x0;o<l['textureData']['length'];o++){let p=l['textureData'][o],q=i['textureData'][o];if(p['width']!==q['width'])return;if(p['height']!==q['height'])return;if(p['itemType']!==q['itemType'])return;if(p['itemType']!==q['itemType'])return;if(p['tiling']['equals'](q['tiling'])===![])return;if(p['offset']['equals'](q['offset'])===![])return;if(p['uvChanel']!==q['uvChanel'])return;if(p['name']!==q['name'])return;if(p['URL']!==q['URL'])return;}if(l['tag']!==undefined&&i['tag']!==undefined){let r=[],s=[];for(const [t,u]of Object['entries'](l['tag'])){let v=String(t);r['push']([v,u]);}for(const [w,x]of Object['entries'](i['tag'])){let y=String(w);s['push']([y,x]);}if(r['length']!==s['length'])return;for(let z=0x0;z<r['length'];z++){if(r[z][0x0]['localeCompare'](s[z][0x0])!==0x0)return;if(r[z][0x1]['value']!==s[z][0x1]['value'])return;if(r[z][0x1]['dataType']['localeCompare'](s[z][0x1]['dataType'])!==0x0)return;}}else{if(l['tag']===undefined&&i['tag']!==undefined)return;else{if(l['tag']!==undefined&&i['tag']===undefined)return;}}j=l['id'];};return e['forEach'](k),j;},this['SetShader']=function(i,j){let k=c['GetMaterial'](i);if(k===undefined)return;k['shaderType']=j,c['InitMaterialUniform'](k);},this['ClearShader']=function(i){let j=c['GetMaterial'](i);if(j===undefined)return;j['shaderType']=b['Enum']['SHADER_TYPES']['NONE'],c['InitMaterialUniform'](j);},this['InitMaterialUniform']=function(i){if(i===undefined)return;i['tag']=c['GetDefaultUniform'](i['shaderType']);},this['GetDefaultUniform']=function(i){if(i===b['Enum']['SHADER_TYPES']['PBR']||i===b['Enum']['SHADER_TYPES']['COLORMAPPBR']||i===b['Enum']['SHADER_TYPES']['ANIMATIONPBR'])return{'u_Roughness':c['GetUniformItem'](0.5,'float'),'u_Metallic':c['GetUniformItem'](0.1,'float')};else{if(i===b['Enum']['SHADER_TYPES']['HORIZONCLOUDS'])return{'u_Direction':c['GetUniformItem'](new b['Vector3'](0x1,0x1,0x1),'vec3'),'u_Frequency':c['GetUniformItem'](2.06434,'float'),'u_Absorption':c['GetUniformItem'](0.730725,'float'),'u_Thickness':c['GetUniformItem'](0xc,'float'),'u_CoverageRatio':c['GetUniformItem'](0x1,'float'),'u_Density':c['GetUniformItem'](0x1,'float'),'u_Step':c['GetUniformItem'](0xf,'integer'),'u_TimeSpeed':c['GetUniformItem'](0x1,'float')};}return undefined;},this['FindTextureFromType']=function(j,k){for(let l=0x0;l<j['textureData']['length'];l++){let m=j['textureData'][l];if(m['itemType']!==texItem['itemType'])continue;return l;}return-0x1;},this['SetTexture']=function(i,j){let k=c['FindTextureFromType'](i,j['itemType']);if(k<0x0)i['textureData']['push'](j);else i['textureData'][k]=j;},this['DeleteTexture']=function(i,j){let k=c['FindTextureFromType'](i,j);if(k<0x0)return;i['textureData'][k]['texture']!==null&&a['gl']['deleteTexture'](i['textureData'][k]['texture']),i['textureData']['splice'](k,0x1);};}}export default Material;