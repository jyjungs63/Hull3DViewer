class Watermark{constructor(a,b){this['VIZCore']=a;let c=this;this['WatermarkList']=[],this['context']=b,this['Visible']=!![],this['Interface']=undefined;function d(k,l){let m='';if(l['bold'])m+='bold\x20';if(l['italic'])m+='italic\x20';k['font']=m+l['size']+'pt\x20'+l['face'],k['fillStyle']='rgba('+l['color']['r']+','+l['color']['g']+','+l['color']['b']+','+l['color']['glAlpha']()+')',k['strokeStyle']='rgba('+l['color']['r']+','+l['color']['g']+','+l['color']['b']+','+l['color']['glAlpha']()+')',k['textBaseline']='alphabetic';};function e(k,l){l['style']['background']['enable']?k['fillStyle']='rgba('+l['style']['background']['color']['r']+','+l['style']['background']['color']['g']+','+l['style']['background']['color']['b']+','+l['style']['background']['color']['glAlpha']()+')':k['fillStyle']='rgba('+l['style']['background']['color']['r']+','+l['style']['background']['color']['g']+','+l['style']['background']['color']['b']+','+0x0+')',l['style']['border']['enable']?(k['strokeStyle']='rgba('+l['style']['border']['color']['r']+','+l['style']['border']['color']['g']+','+l['style']['border']['color']['b']+','+l['style']['border']['color']['glAlpha']()+')',k['lineWidth']=l['style']['border']['thickness']):(k['strokeStyle']='rgba('+l['style']['border']['color']['r']+','+l['style']['border']['color']['g']+','+l['style']['border']['color']['b']+','+0x0+')',k['lineWidth']=l['style']['border']['thickness']);};function f(k,l,m){let n=undefined,o=k['font'],p='';if(m['bold'])p+='bold\x20';if(m['italic'])p+='italic\x20';k['font']=p+m['size']+'pt\x20'+m['face'];for(let q=0x0;q<l['length'];q++){let r=k['measureText'](l[q]);if(n===undefined)n=r;else{if(n['width']<r['width'])n=r;}}return l['length']>0x0&&(n['height']=m['size']*1.5,n['ascent']=m['size']+m['size']*0.1,n['descent']=m['size']*0.15),k['font']=o,n;}function g(k,l,m,n,o,p,q,s){k['beginPath'](),k['moveTo'](l+p,m),k['lineTo'](l+n-p,m),k['quadraticCurveTo'](l+n,m,l+n,m+p),k['lineTo'](l+n,m+o-p),k['quadraticCurveTo'](l+n,m+o,l+n-p,m+o),k['lineTo'](l+p,m+o),k['quadraticCurveTo'](l,m+o,l,m+o-p),k['lineTo'](l,m+p),k['quadraticCurveTo'](l,m,l+p,m),k['closePath']();if(q)k['fill']();if(s)k['stroke']();}function h(k,l,m,n,o,p,q,s,t,u,v,z){k['beginPath']();t?(k['moveTo'](l,m+p),k['quadraticCurveTo'](l,m,l+p,m)):(k['moveTo'](l,m-p),k['lineTo'](l,m),k['lineTo'](l+p,m));k['lineTo'](l-p+n,m);u?k['quadraticCurveTo'](l+n,m,l+n,m+p):(k['lineTo'](l+p+n+p,m),k['lineTo'](l+p+n+p,m+p));k['lineTo'](l+n,m+o-p);z?k['quadraticCurveTo'](l+n,m+o,l+n-p,m+o):(k['lineTo'](l+n,m+o),k['lineTo'](l+n-p,m+o));k['lineTo'](l+p,m+o);v?k['quadraticCurveTo'](l,m+o,l,m+o-p):(k['lineTo'](l,m+o),k['lineTo'](l,m+o-p));k['lineTo'](l,m-p),k['closePath']();if(q)k['fill']();if(s)k['stroke']();}function i(k,l,m,n,o,p,q){if(p)k['fillRect'](l,m,n,o);if(q)k['strokeRect'](l,m,n,o);}function j(k){if(k['text']['value']['length']===0x0)return;if(k['context']===undefined)k['context']=c['context'];let l=0x1;const m=f(k['context'],k['text']['value'],k['style']['font']);let n=m['width']+k['style']['border']['offset']*0x2,o=m['height']*k['text']['value']['length']+k['style']['border']['offset']*0x2;if(k['icon']!==undefined){if(k['icon']['image']['width']>n)n=k['icon']['image']['width'];o=o+k['icon']['image']['height'];}let p={'x':k['style']['offset']['left'],'y':k['style']['offset']['top'],'width':n,'height':o,'repeatOffset':{'x':0x0,'y':0x0}},q={'x':0x0,'y':0x0},r=p['x']+k['style']['border']['offset'],s=p['y']+k['style']['border']['offset'];p['width']=n,p['height']=o;if(k['icon']['image']!==undefined){if(k['icon']['align']===a['Enum']['ALIGN']['TOP_LEFT']||k['icon']['align']===a['Enum']['ALIGN']['MIDDLE_LEFT']||k['icon']['align']===a['Enum']['ALIGN']['BOTTOM_LEFT'])r-=k['icon']['size']+k['icon']['offset']*0x2,n+=k['icon']['size']+k['icon']['offset']*0x2,p['width']+=k['icon']['size']+k['icon']['offset']*0x2,q['x']+=k['icon']['offset'];else(k['icon']['align']===a['Enum']['ALIGN']['TOP_RIGHT']||k['icon']['align']===a['Enum']['ALIGN']['MIDDLE_RIGHT']||k['icon']['align']===a['Enum']['ALIGN']['BOTTOM_RIGHT'])&&(n+=k['icon']['size']+k['icon']['offset']*0x2,p['width']+=k['icon']['size']+k['icon']['offset']*0x2);}if(k['style']['ratio']!==undefined&&k['style']['ratio']['use']===!![]){let z=k['context']['canvas']['width'],A=k['context']['canvas']['height'],B=z*k['style']['ratio']['horizontal'],C=A*k['style']['ratio']['vertical'];p['x']+=B-p['width']/0x2,p['y']+=C-p['height']/0x2;if(p['x']<0x0)p['x']=0x0;if(p['y']<0x0)p['y']=0x0;}let t=function(){let D={'x':0x0,'y':0x0};{if(k['style']['rotate']!==0x0){k['context']['save']();let E=p['x']+p['width']/0x2,F=p['y']+p['height']/0x2;b['translate'](E,F),k['context']['rotate'](Math['PI']/0xb4*k['style']['rotate']),b['translate'](-E,-F);}e(k['context'],k);if(k['style']['border']['type']===0x0)i(k['context'],p['x'],p['y'],p['width'],p['height'],k['style']['background']['enable'],k['style']['border']['enable']);else{if(k['style']['border']['type']===0x1)g(k['context'],p['x'],p['y'],p['width'],p['height'],k['style']['border']['round'],k['style']['background']['enable'],k['style']['border']['enable']);}D['y']+=k['style']['border']['offset'];{let G=k['icon']['size'],H=k['icon']['size'],I=k['icon']['image']['width'],J=k['icon']['image']['height'];I>J?(G=k['icon']['image']['width']*k['icon']['size']/k['icon']['image']['height'],H=k['icon']['size']):(G=k['icon']['size'],H=k['icon']['image']['height']*k['icon']['size']/k['icon']['image']['width']);if(G<=0x0)G=k['icon']['image']['width'];if(H<=0x0)H=k['icon']['image']['height'];let K=p['x'],L=p['y'],M=K+k['icon']['offset'],N=L+k['icon']['offset'];switch(k['icon']['align']){case a['Enum']['ALIGN']['TOP_LEFT']:{D['x']+=G;}break;case a['Enum']['ALIGN']['MIDDLE_LEFT']:{N=L+p['height']*0.5-H/0x2,D['x']+=G;}break;case a['Enum']['ALIGN']['BOTTOM_LEFT']:{N=L+p['height']-H-k['icon']['offset'],D['x']+=G;}break;case a['Enum']['ALIGN']['TOP_RIGHT']:{M+=p['width']-k['icon']['size']-k['icon']['offset']*0x2-k['style']['border']['offset'];}break;case a['Enum']['ALIGN']['MIDDLE_RIGHT']:{M+=p['width']-k['icon']['size']-k['icon']['offset']*0x2-k['style']['border']['offset'],N=L+p['height']*0.5-H/0x2;}break;case a['Enum']['ALIGN']['BOTTOM_RIGHT']:{M+=p['width']-k['icon']['size']-k['icon']['offset']*0x2-k['style']['border']['offset'],N=L+p['height']-H-k['icon']['offset'];}break;}k['context']['drawImage'](k['icon']['image'],M,N,G,H);}}d(k['context'],k['style']['font']);for(let O=0x0;O<k['text']['value']['length'];O++){if(k['style']['font']['stroke'])k['context']['strokeText'](k['text']['value'][O],p['x']+D['x'],p['y']+D['y']+(m['ascent']*O+m['ascent']+k['style']['border']['offset']*O+m['descent']));else k['context']['fillText'](k['text']['value'][O],p['x']+D['x'],p['y']+D['y']+(m['ascent']*O+m['ascent']+k['style']['border']['offset']*O+m['descent']));}k['style']['rotate']!==0x0&&k['context']['restore']();},u=0x1,v=0x1;if(k['style']['repeat']['use']){u=b['canvas']['clientWidth']/p['width'],v=b['canvas']['clientHeight']/p['height'];for(let D=0x0;D<u;D++){for(let E=0x0;E<v;E++){{p['x']=k['style']['repeat']['offset']['x']*D,p['y']=k['style']['repeat']['offset']['y']*E;}t();}}}else t();}this['DrawWatermark']=function(k){j(k);};}['New'](){let a={'text':{'value':[]},'icon':{'image':undefined,'size':0x20,'offset':0x2,'align':this['VIZCore']['Enum']['ALIGN']['MIDDLE_LEFT']},'style':{'font':{'face':'Arial','size':0xc,'color':new this['VIZCore']['Color'](),'bold':![],'italic':![],'stroke':![]},'border':{'enable':!![],'color':new this['VIZCore']['Color'](),'thickness':0x1,'type':0x0,'round':0x5,'offset':0x5},'background':{'enable':!![],'color':new this['VIZCore']['Color']()},'offset':{'left':0x0,'top':0x0},'ratio':{'use':![],'vertical':0x0,'horizontal':0x0},'rotate':0x0,'repeat':{'use':![],'offset':{'x':0x32,'y':0x32}}}};return a;}['Add'](a){this['WatermarkList']['push'](a);}['Render'](){if(this['Visible'])for(let a=0x0;a<this['WatermarkList']['length'];a++){let b=this['WatermarkList'][a];this['DrawWatermark'](b);}}['Show'](a){this['Visible']=a,this['Interface']!==undefined&&(this['Interface']['useDrawing']===undefined||this['Interface']['useDrawing']===![]?this['Interface']['Draw']():this['Interface']['Drawing']['DrawSketch']());}}export default Watermark;