<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì„ ì²´ 3D ìƒì‚°ë„ë©´</title>
    <!-- jsTree CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/themes/default/style.min.css" />

    <!-- jQuery (í•„ìˆ˜) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- jsTree JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.12/jstree.min.js"></script>
    <script src="3dData.js"></script>
    <!-- Three.js + GLTFLoader + OrbitControls -->
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.169.0/build/three.module.min.js",
          "three/examples/jsm/loaders/GLTFLoader.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/loaders/GLTFLoader.js",
          "three/examples/jsm/controls/OrbitControls.js": "https://cdn.jsdelivr.net/npm/three@0.169/examples/jsm/controls/OrbitControls.js",
          "three/examples/jsm/loaders/DRACOLoader.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/loaders/DRACOLoader.js",
          "three/examples/jsm/environments/RoomEnvironment.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/environments/RoomEnvironment.js",
          "three/examples/jsm/postprocessing/EffectComposer.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/EffectComposer.js",
          "three/examples/jsm/postprocessing/RenderPass.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/RenderPass.js",
          "three/examples/jsm/postprocessing/OutputPass.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/OutputPass.js",
          "three/examples/jsm/libs/lil-gui.module.min.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/libs/lil-gui.module.min.js",
          "three/examples/jsm/postprocessing/OutlinePass.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/OutlinePass.js",
          "three/examples/jsm/postprocessing/UnrealBloomPass.js": "https://cdn.jsdelivr.net/npm/three@0.169.0/examples/jsm/postprocessing/UnrealBloomPass.js"
        }
      }
    </script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="VIZCore3D/Resource/css/VIZCore.css">
  </head>
  <body>
    <div class="container">
      <div class="menubar">
        <h3>ğŸš¢ ì„ ì²´ 3D ì¡°ë¦½ì •ë³´</h3>
        <div class="menu-controls">
          <button class="menu-btn" onclick="resetLayout()">ğŸ”„ Reset</button>
          <button class="menu-btn" onclick="toggleFullscreen()">
            â›¶ Fullscreen
          </button>
          <button class="menu-btn" onclick="saveLayout()">ğŸ’¾ Save</button>
        </div>
      </div>

      <div class="main-content">
        <div class="left-panel" id="leftPanel">
          <button class="toggle-btn" onclick="toggleLeftPanel()">â—€</button>
          <div class="panel-content" style="display: flex; flex-direction: column; height: 100%; align-items: center;">
            <!-- ê²€ìƒ‰ í¼ (width 80%) -->
            <div style="flex: none; width: 90%; padding: 10px 12px; border-bottom: 1px solid #ddd">
              <form id="searchForm" onsubmit="return false;" style="width: 100%;">
                <!-- ìŠ¹ì„  -->
                <div style="margin-bottom: 10px">
                  <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px;">í˜¸ì„ </label>
                  <div style="display: flex; gap: 5px">
                    <input type="text" id="ìŠ¹ì„ "  placeholder="H1234" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; min-width: 0;" />
                    <button type="button" onclick="searchìŠ¹ì„ ()" style="padding: 8px 12px; background: white; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; flex-shrink: 0;">â˜°</button>
                  </div>
                </div>

                <!-- ì„¤ê³„ë¶€ì„œ -->
                <div style="margin-bottom: 10px">
                  <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px;">ë¸”ëŸ­</label>
                  <div style="display: flex; gap: 5px">
                    <input type="text" id="idBlock" onkeydown="if (event.key === 'Enter') selectBlock()" placeholder="AYF201" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; min-width: 0;" />
                    <button type="button" onclick="selectBlock()" style="padding: 8px 12px; background: white; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; flex-shrink: 0;">ğŸ”</button>
                  </div>
                </div>

                <!-- ë„ë©´ë²ˆí˜¸ -->
                <div style="margin-bottom: 10px">
                  <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px;">ë„ë©´ë²ˆí˜¸</label>
                  <div style="display: flex; gap: 5px">
                    <input type="text" id="ë„ë©´ë²ˆí˜¸" placeholder="DWG-2024-001" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; min-width: 0;" />
                    <button type="button" onclick="searchë„ë©´ë²ˆí˜¸()" style="padding: 8px 12px; background: white; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; flex-shrink: 0;">ğŸ”</button>
                  </div>
                </div>

                <!-- ë„ë©´ëª… -->
                <div style="margin-bottom: 10px">
                  <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px;" >ë„ë©´ëª…</label>
                  <input type="text" id="ë„ë©´ëª…" placeholder="ì„ ì²´ì¡°ë¦½ë„" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px;" />
                </div>
              </form>
            </div>
          <div style="height: 5px; width: 100%; background-color: #f0f0f0; border-top: 1px solid #ccc;"></div>
            <!-- jsTree (ë‚¨ì€ ê³µê°„ ëª¨ë‘ ì°¨ì§€) -->
            <div id="jstree" style="flex: 1; overflow: auto; padding: 0px; margin-top: 10px;" ></div>
          </div>
          <div class="resizer resizer-h-thin" data-resize="left"></div>
        </div>

        <div class="center-panel">
          <div class="top-row">
            <div id="view1" class="view-panel"></div>
            <div class="resizer resizer-v-between" data-resize="view1-h"></div>
            <div id="view2" class="view-panel">
              <!-- <div class="resizer resizer-v-thin" data-resize="view1-v"></div> -->
            </div>
          </div>
          <div class="resizer resizer-v" data-resize="topRow"></div>

          <div class="bottom-row">
            <div id="view3" class="view-panel"></div>
            <div class="resizer resizer-v-between" data-resize="view3-h"></div>
            <div id="images" class="view-panel">

            </div>
          </div>
        </div>

        <div class="right-panel" id="rightPanel">
          <div class="right-top" id="rightTop"> 
              <iframe src="VIZWide3D/index.html" style="width: 100%; height: 100%; border: none;"  id="rightIframe" > </iframe>
              <div class="resizer resizer-v-thin" data-resize="rightTop"></div>
          </div>

          <div class="right-bottom">
            <iframe src="property-tabs.html" style="width: 100%; height: 100%; border: none;"  id="rightIframe" > </iframe>
          </div>
        </div>
      </div>

      <div class="console" id="console">
        <div class="console-resizer" id="consoleResizer"></div>
        <div id="myconsole">
          <div class="console-header">
            <span></span>
            <button class="toggle-btn" onclick="toggleConsole()">â–¼</button>
          </div>
          <div class="console-content" style="margin-top: -30px"></div>
        </div>
      </div>
    </div>
    <!-- ëª¨ë‹¬ íŒì—… -->
    <div id="propertyModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3> âš™ï¸ ì†ì„± ë³´ê¸°</h3>
        <div id="propertyContent">ì—¬ê¸°ì— ì†ì„± ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
      </div>
    </div>

    
    <script type="module" src="main.js"></script>
  </body>
</html>